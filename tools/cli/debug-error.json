{
  "name": "AI_InvalidPromptError",
  "cause": {
    "name": "AI_TypeValidationError",
    "cause": {
      "name": "ZodError",
      "message": "[\n  {\n    \"code\": \"invalid_union\",\n    \"errors\": [\n      [\n        {\n          \"code\": \"invalid_value\",\n          \"values\": [\n            \"system\"\n          ],\n          \"path\": [\n            \"role\"\n          ],\n          \"message\": \"Invalid input: expected \\\"system\\\"\"\n        },\n        {\n          \"expected\": \"string\",\n          \"code\": \"invalid_type\",\n          \"path\": [\n            \"content\"\n          ],\n          \"message\": \"Invalid input: expected string, received array\"\n        }\n      ],\n      [\n        {\n          \"code\": \"invalid_value\",\n          \"values\": [\n            \"user\"\n          ],\n          \"path\": [\n            \"role\"\n          ],\n          \"message\": \"Invalid input: expected \\\"user\\\"\"\n        },\n        {\n          \"code\": \"invalid_union\",\n          \"errors\": [\n            [\n              {\n                \"expected\": \"string\",\n                \"code\": \"invalid_type\",\n                \"path\": [],\n                \"message\": \"Invalid input: expected string, received array\"\n              }\n            ],\n            [\n              {\n                \"code\": \"invalid_union\",\n                \"errors\": [\n                  [\n                    {\n                      \"code\": \"invalid_value\",\n                      \"values\": [\n                        \"text\"\n                      ],\n                      \"path\": [\n                        \"type\"\n                      ],\n                      \"message\": \"Invalid input: expected \\\"text\\\"\"\n                    },\n                    {\n                      \"expected\": \"string\",\n                      \"code\": \"invalid_type\",\n                      \"path\": [\n                        \"text\"\n                      ],\n                      \"message\": \"Invalid input: expected string, received undefined\"\n                    }\n                  ],\n                  [\n                    {\n                      \"code\": \"invalid_value\",\n                      \"values\": [\n                        \"image\"\n                      ],\n                      \"path\": [\n                        \"type\"\n                      ],\n                      \"message\": \"Invalid input: expected \\\"image\\\"\"\n                    },\n                    {\n                      \"code\": \"invalid_union\",\n                      \"errors\": [\n                        [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"errors\": [\n                              [\n                                {\n                                  \"expected\": \"string\",\n                                  \"code\": \"invalid_type\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected string, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"invalid_type\",\n                                  \"expected\": \"Uint8Array\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected Uint8Array, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"invalid_type\",\n                                  \"expected\": \"ArrayBuffer\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected ArrayBuffer, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"custom\",\n                                  \"path\": [],\n                                  \"message\": \"Must be a Buffer\"\n                                }\n                              ]\n                            ],\n                            \"path\": [],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"URL\",\n                            \"path\": [],\n                            \"message\": \"Invalid input: expected URL, received undefined\"\n                          }\n                        ]\n                      ],\n                      \"path\": [\n                        \"image\"\n                      ],\n                      \"message\": \"Invalid input\"\n                    }\n                  ],\n                  [\n                    {\n                      \"code\": \"invalid_value\",\n                      \"values\": [\n                        \"file\"\n                      ],\n                      \"path\": [\n                        \"type\"\n                      ],\n                      \"message\": \"Invalid input: expected \\\"file\\\"\"\n                    },\n                    {\n                      \"code\": \"invalid_union\",\n                      \"errors\": [\n                        [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"errors\": [\n                              [\n                                {\n                                  \"expected\": \"string\",\n                                  \"code\": \"invalid_type\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected string, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"invalid_type\",\n                                  \"expected\": \"Uint8Array\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected Uint8Array, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"invalid_type\",\n                                  \"expected\": \"ArrayBuffer\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected ArrayBuffer, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"custom\",\n                                  \"path\": [],\n                                  \"message\": \"Must be a Buffer\"\n                                }\n                              ]\n                            ],\n                            \"path\": [],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"URL\",\n                            \"path\": [],\n                            \"message\": \"Invalid input: expected URL, received undefined\"\n                          }\n                        ]\n                      ],\n                      \"path\": [\n                        \"data\"\n                      ],\n                      \"message\": \"Invalid input\"\n                    },\n                    {\n                      \"expected\": \"string\",\n                      \"code\": \"invalid_type\",\n                      \"path\": [\n                        \"mediaType\"\n                      ],\n                      \"message\": \"Invalid input: expected string, received undefined\"\n                    }\n                  ]\n                ],\n                \"path\": [\n                  0\n                ],\n                \"message\": \"Invalid input\"\n              }\n            ]\n          ],\n          \"path\": [\n            \"content\"\n          ],\n          \"message\": \"Invalid input\"\n        }\n      ],\n      [\n        {\n          \"code\": \"invalid_value\",\n          \"values\": [\n            \"assistant\"\n          ],\n          \"path\": [\n            \"role\"\n          ],\n          \"message\": \"Invalid input: expected \\\"assistant\\\"\"\n        },\n        {\n          \"code\": \"invalid_union\",\n          \"errors\": [\n            [\n              {\n                \"expected\": \"string\",\n                \"code\": \"invalid_type\",\n                \"path\": [],\n                \"message\": \"Invalid input: expected string, received array\"\n              }\n            ],\n            [\n              {\n                \"code\": \"invalid_union\",\n                \"errors\": [\n                  [\n                    {\n                      \"code\": \"invalid_value\",\n                      \"values\": [\n                        \"text\"\n                      ],\n                      \"path\": [\n                        \"type\"\n                      ],\n                      \"message\": \"Invalid input: expected \\\"text\\\"\"\n                    },\n                    {\n                      \"expected\": \"string\",\n                      \"code\": \"invalid_type\",\n                      \"path\": [\n                        \"text\"\n                      ],\n                      \"message\": \"Invalid input: expected string, received undefined\"\n                    }\n                  ],\n                  [\n                    {\n                      \"code\": \"invalid_value\",\n                      \"values\": [\n                        \"file\"\n                      ],\n                      \"path\": [\n                        \"type\"\n                      ],\n                      \"message\": \"Invalid input: expected \\\"file\\\"\"\n                    },\n                    {\n                      \"code\": \"invalid_union\",\n                      \"errors\": [\n                        [\n                          {\n                            \"code\": \"invalid_union\",\n                            \"errors\": [\n                              [\n                                {\n                                  \"expected\": \"string\",\n                                  \"code\": \"invalid_type\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected string, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"invalid_type\",\n                                  \"expected\": \"Uint8Array\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected Uint8Array, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"invalid_type\",\n                                  \"expected\": \"ArrayBuffer\",\n                                  \"path\": [],\n                                  \"message\": \"Invalid input: expected ArrayBuffer, received undefined\"\n                                }\n                              ],\n                              [\n                                {\n                                  \"code\": \"custom\",\n                                  \"path\": [],\n                                  \"message\": \"Must be a Buffer\"\n                                }\n                              ]\n                            ],\n                            \"path\": [],\n                            \"message\": \"Invalid input\"\n                          }\n                        ],\n                        [\n                          {\n                            \"code\": \"invalid_type\",\n                            \"expected\": \"URL\",\n                            \"path\": [],\n                            \"message\": \"Invalid input: expected URL, received undefined\"\n                          }\n                        ]\n                      ],\n                      \"path\": [\n                        \"data\"\n                      ],\n                      \"message\": \"Invalid input\"\n                    },\n                    {\n                      \"expected\": \"string\",\n                      \"code\": \"invalid_type\",\n                      \"path\": [\n                        \"mediaType\"\n                      ],\n                      \"message\": \"Invalid input: expected string, received undefined\"\n                    }\n                  ],\n                  [\n                    {\n                      \"code\": \"invalid_value\",\n                      \"values\": [\n                        \"reasoning\"\n                      ],\n                      \"path\": [\n                        \"type\"\n                      ],\n                      \"message\": \"Invalid input: expected \\\"reasoning\\\"\"\n                    },\n                    {\n                      \"expected\": \"string\",\n                      \"code\": \"invalid_type\",\n                      \"path\": [\n                        \"text\"\n                      ],\n                      \"message\": \"Invalid input: expected string, received undefined\"\n                    }\n                  ],\n                  [\n                    {\n                      \"code\": \"invalid_value\",\n                      \"values\": [\n                        \"tool-call\"\n                      ],\n                      \"path\": [\n                        \"type\"\n                      ],\n                      \"message\": \"Invalid input: expected \\\"tool-call\\\"\"\n                    }\n                  ],\n                  [\n                    {\n                      \"code\": \"invalid_type\",\n                      \"expected\": \"object\",\n                      \"path\": [\n                        \"output\"\n                      ],\n                      \"message\": \"Invalid input: expected object, received undefined\"\n                    }\n                  ],\n                  [\n                    {\n                      \"code\": \"invalid_value\",\n                      \"values\": [\n                        \"tool-approval-request\"\n                      ],\n                      \"path\": [\n                        \"type\"\n                      ],\n                      \"message\": \"Invalid input: expected \\\"tool-approval-request\\\"\"\n                    },\n                    {\n                      \"expected\": \"string\",\n                      \"code\": \"invalid_type\",\n                      \"path\": [\n                        \"approvalId\"\n                      ],\n                      \"message\": \"Invalid input: expected string, received undefined\"\n                    }\n                  ]\n                ],\n                \"path\": [\n                  0\n                ],\n                \"message\": \"Invalid input\"\n              }\n            ]\n          ],\n          \"path\": [\n            \"content\"\n          ],\n          \"message\": \"Invalid input\"\n        }\n      ],\n      [\n        {\n          \"code\": \"invalid_union\",\n          \"errors\": [\n            [\n              {\n                \"code\": \"invalid_type\",\n                \"expected\": \"object\",\n                \"path\": [\n                  \"output\"\n                ],\n                \"message\": \"Invalid input: expected object, received undefined\"\n              }\n            ],\n            [\n              {\n                \"code\": \"invalid_value\",\n                \"values\": [\n                  \"tool-approval-response\"\n                ],\n                \"path\": [\n                  \"type\"\n                ],\n                \"message\": \"Invalid input: expected \\\"tool-approval-response\\\"\"\n              },\n              {\n                \"expected\": \"string\",\n                \"code\": \"invalid_type\",\n                \"path\": [\n                  \"approvalId\"\n                ],\n                \"message\": \"Invalid input: expected string, received undefined\"\n              },\n              {\n                \"expected\": \"boolean\",\n                \"code\": \"invalid_type\",\n                \"path\": [\n                  \"approved\"\n                ],\n                \"message\": \"Invalid input: expected boolean, received undefined\"\n              }\n            ]\n          ],\n          \"path\": [\n            \"content\",\n            0\n          ],\n          \"message\": \"Invalid input\"\n        }\n      ]\n    ],\n    \"path\": [\n      2\n    ],\n    \"message\": \"Invalid input\"\n  }\n]"
    },
    "value": [
      {
        "role": "user",
        "content": "Classify..."
      },
      {
        "role": "assistant",
        "content": [
          {
            "type": "text",
            "text": "reading..."
          },
          {
            "type": "tool-call",
            "toolCallId": "call_mock_123",
            "toolName": "read_file_preview",
            "args": {
              "filePath": "foo"
            }
          }
        ]
      },
      {
        "role": "tool",
        "content": [
          {
            "type": "tool-result",
            "toolCallId": "call_mock_123",
            "toolName": "read_file_preview",
            "result": {
              "content": "content"
            }
          }
        ]
      }
    ]
  },
  "prompt": {
    "messages": [
      {
        "role": "user",
        "content": "Classify..."
      },
      {
        "role": "assistant",
        "content": [
          {
            "type": "text",
            "text": "reading..."
          },
          {
            "type": "tool-call",
            "toolCallId": "call_mock_123",
            "toolName": "read_file_preview",
            "args": {
              "filePath": "foo"
            }
          }
        ]
      },
      {
        "role": "tool",
        "content": [
          {
            "type": "tool-result",
            "toolCallId": "call_mock_123",
            "toolName": "read_file_preview",
            "result": {
              "content": "content"
            }
          }
        ]
      }
    ]
  }
}